#' Wrangle goemotion output into a nice format
#'
#' @param df The dataframe output from the python emotion script
#'
#' @return A dataframe
#' @export
#'
extract_emotion_goemotion <- function(df) {

  extract_emotion <- function(df, emotion, column_1, column_2, column_3, column_4,
                              column_5, column_6, column_7, column_8,
                              column_9, column_10, column_11, column_12,
                              column_13, column_14, column_15, column_16,
                              column_17, column_18, column_19, column_20,
                              column_21, column_22, column_23, column_24,
                              column_25, column_26, column_27, column_28) {

    df %>%
      janitor::clean_names() %>%
      dplyr::mutate(!!quo_name(emotion) := case_when(str_detect({{ column_1 }}, emotion) ~ readr::parse_number({{ column_1 }}),
                                                     str_detect({{ column_2 }}, emotion) ~ readr::parse_number({{ column_2 }}),
                                                     str_detect({{ column_3 }}, emotion) ~ readr::parse_number({{ column_3 }}),
                                                     str_detect({{ column_4 }}, emotion) ~ readr::parse_number({{ column_4 }}),
                                                     str_detect({{ column_5 }}, emotion) ~ readr::parse_number({{ column_5 }}),
                                                     str_detect({{ column_6 }}, emotion) ~ readr::parse_number({{ column_6 }}),
                                                     str_detect({{ column_7 }}, emotion) ~ readr::parse_number({{ column_7 }}),
                                                     str_detect({{ column_8 }}, emotion) ~ readr::parse_number({{ column_8 }}),
                                                     str_detect({{ column_9 }}, emotion) ~ readr::parse_number({{ column_9 }}),
                                                     str_detect({{ column_10 }}, emotion) ~ readr::parse_number({{ column_10 }}),
                                                     str_detect({{ column_11 }}, emotion) ~ readr::parse_number({{ column_11 }}),
                                                     str_detect({{ column_12 }}, emotion) ~ readr::parse_number({{ column_12 }}),
                                                     str_detect({{ column_13 }}, emotion) ~ readr::parse_number({{ column_13 }}),
                                                     str_detect({{ column_14 }}, emotion) ~ readr::parse_number({{ column_14 }}),
                                                     str_detect({{ column_15 }}, emotion) ~ readr::parse_number({{ column_15 }}),
                                                     str_detect({{ column_16 }}, emotion) ~ readr::parse_number({{ column_16 }}),
                                                     str_detect({{ column_17 }}, emotion) ~ readr::parse_number({{ column_17 }}),
                                                     str_detect({{ column_18 }}, emotion) ~ readr::parse_number({{ column_18 }}),
                                                     str_detect({{ column_19 }}, emotion) ~ readr::parse_number({{ column_19 }}),
                                                     str_detect({{ column_20 }}, emotion) ~ readr::parse_number({{ column_20 }}),
                                                     str_detect({{ column_21 }}, emotion) ~ readr::parse_number({{ column_21 }}),
                                                     str_detect({{ column_22 }}, emotion) ~ readr::parse_number({{ column_22 }}),
                                                     str_detect({{ column_23 }}, emotion) ~ readr::parse_number({{ column_23 }}),
                                                     str_detect({{ column_24 }}, emotion) ~ readr::parse_number({{ column_24 }}),
                                                     str_detect({{ column_25 }}, emotion) ~ readr::parse_number({{ column_25 }}),
                                                     str_detect({{ column_26 }}, emotion) ~ readr::parse_number({{ column_26 }}),
                                                     str_detect({{ column_27 }}, emotion) ~ readr::parse_number({{ column_27 }}),
                                                     str_detect({{ column_28 }}, emotion) ~ readr::parse_number({{ column_28 }}),
                                                     T ~ NA_real_))
  }

  df %>%
    janitor::clean_names() %>%
    extract_emotion(emotion = "admiration", column_1 = x0, column_2 = x1, column_3 = x2, column_4 = x3,
                    column_5 = x4, column_6 = x5, column_7 = x6, column_8 = x7,
                    column_9 = x8, column_10 = x9, column_11 = x10, column_12 = x11,
                    column_13 = x12, column_14 = x13, column_15 = x14, column_16 = x15,
                    column_17 = x16, column_18 = x17, column_19 = x18, column_20 = x19,
                    column_21 = x20, column_22 = x21, column_23 = x22, column_24 = x23,
                    column_25 = x24, column_26 = x25, column_27 = x26, column_28 = x27) %>%
    extract_emotion(emotion = "amusement", column_1 = x0, column_2 = x1, column_3 = x2, column_4 = x3,
                    column_5 = x4, column_6 = x5, column_7 = x6, column_8 = x7,
                    column_9 = x8, column_10 = x9, column_11 = x10, column_12 = x11,
                    column_13 = x12, column_14 = x13, column_15 = x14, column_16 = x15,
                    column_17 = x16, column_18 = x17, column_19 = x18, column_20 = x19,
                    column_21 = x20, column_22 = x21, column_23 = x22, column_24 = x23,
                    column_25 = x24, column_26 = x25, column_27 = x26, column_28 = x27) %>%
    extract_emotion(emotion = "anger", column_1 = x0, column_2 = x1, column_3 = x2, column_4 = x3,
                    column_5 = x4, column_6 = x5, column_7 = x6, column_8 = x7,
                    column_9 = x8, column_10 = x9, column_11 = x10, column_12 = x11,
                    column_13 = x12, column_14 = x13, column_15 = x14, column_16 = x15,
                    column_17 = x16, column_18 = x17, column_19 = x18, column_20 = x19,
                    column_21 = x20, column_22 = x21, column_23 = x22, column_24 = x23,
                    column_25 = x24, column_26 = x25, column_27 = x26, column_28 = x27) %>%
    extract_emotion(emotion = "annoyance", column_1 = x0, column_2 = x1, column_3 = x2, column_4 = x3,
                    column_5 = x4, column_6 = x5, column_7 = x6, column_8 = x7,
                    column_9 = x8, column_10 = x9, column_11 = x10, column_12 = x11,
                    column_13 = x12, column_14 = x13, column_15 = x14, column_16 = x15,
                    column_17 = x16, column_18 = x17, column_19 = x18, column_20 = x19,
                    column_21 = x20, column_22 = x21, column_23 = x22, column_24 = x23,
                    column_25 = x24, column_26 = x25, column_27 = x26, column_28 = x27) %>%
    extract_emotion(emotion = "approval", column_1 = x0, column_2 = x1, column_3 = x2, column_4 = x3,
                    column_5 = x4, column_6 = x5, column_7 = x6, column_8 = x7,
                    column_9 = x8, column_10 = x9, column_11 = x10, column_12 = x11,
                    column_13 = x12, column_14 = x13, column_15 = x14, column_16 = x15,
                    column_17 = x16, column_18 = x17, column_19 = x18, column_20 = x19,
                    column_21 = x20, column_22 = x21, column_23 = x22, column_24 = x23,
                    column_25 = x24, column_26 = x25, column_27 = x26, column_28 = x27) %>%
    extract_emotion(emotion = "caring", column_1 = x0, column_2 = x1, column_3 = x2, column_4 = x3,
                    column_5 = x4, column_6 = x5, column_7 = x6, column_8 = x7,
                    column_9 = x8, column_10 = x9, column_11 = x10, column_12 = x11,
                    column_13 = x12, column_14 = x13, column_15 = x14, column_16 = x15,
                    column_17 = x16, column_18 = x17, column_19 = x18, column_20 = x19,
                    column_21 = x20, column_22 = x21, column_23 = x22, column_24 = x23,
                    column_25 = x24, column_26 = x25, column_27 = x26, column_28 = x27) %>%
    extract_emotion(emotion = "confusion", column_1 = x0, column_2 = x1, column_3 = x2, column_4 = x3,
                    column_5 = x4, column_6 = x5, column_7 = x6, column_8 = x7,
                    column_9 = x8, column_10 = x9, column_11 = x10, column_12 = x11,
                    column_13 = x12, column_14 = x13, column_15 = x14, column_16 = x15,
                    column_17 = x16, column_18 = x17, column_19 = x18, column_20 = x19,
                    column_21 = x20, column_22 = x21, column_23 = x22, column_24 = x23,
                    column_25 = x24, column_26 = x25, column_27 = x26, column_28 = x27) %>%
    extract_emotion(emotion = "curiosity", column_1 = x0, column_2 = x1, column_3 = x2, column_4 = x3,
                    column_5 = x4, column_6 = x5, column_7 = x6, column_8 = x7,
                    column_9 = x8, column_10 = x9, column_11 = x10, column_12 = x11,
                    column_13 = x12, column_14 = x13, column_15 = x14, column_16 = x15,
                    column_17 = x16, column_18 = x17, column_19 = x18, column_20 = x19,
                    column_21 = x20, column_22 = x21, column_23 = x22, column_24 = x23,
                    column_25 = x24, column_26 = x25, column_27 = x26, column_28 = x27) %>%
    extract_emotion(emotion = "desire", column_1 = x0, column_2 = x1, column_3 = x2, column_4 = x3,
                    column_5 = x4, column_6 = x5, column_7 = x6, column_8 = x7,
                    column_9 = x8, column_10 = x9, column_11 = x10, column_12 = x11,
                    column_13 = x12, column_14 = x13, column_15 = x14, column_16 = x15,
                    column_17 = x16, column_18 = x17, column_19 = x18, column_20 = x19,
                    column_21 = x20, column_22 = x21, column_23 = x22, column_24 = x23,
                    column_25 = x24, column_26 = x25, column_27 = x26, column_28 = x27) %>%
    extract_emotion(emotion = "disappointment", column_1 = x0, column_2 = x1, column_3 = x2, column_4 = x3,
                    column_5 = x4, column_6 = x5, column_7 = x6, column_8 = x7,
                    column_9 = x8, column_10 = x9, column_11 = x10, column_12 = x11,
                    column_13 = x12, column_14 = x13, column_15 = x14, column_16 = x15,
                    column_17 = x16, column_18 = x17, column_19 = x18, column_20 = x19,
                    column_21 = x20, column_22 = x21, column_23 = x22, column_24 = x23,
                    column_25 = x24, column_26 = x25, column_27 = x26, column_28 = x27) %>%
    extract_emotion(emotion = "disapproval", column_1 = x0, column_2 = x1, column_3 = x2, column_4 = x3,
                    column_5 = x4, column_6 = x5, column_7 = x6, column_8 = x7,
                    column_9 = x8, column_10 = x9, column_11 = x10, column_12 = x11,
                    column_13 = x12, column_14 = x13, column_15 = x14, column_16 = x15,
                    column_17 = x16, column_18 = x17, column_19 = x18, column_20 = x19,
                    column_21 = x20, column_22 = x21, column_23 = x22, column_24 = x23,
                    column_25 = x24, column_26 = x25, column_27 = x26, column_28 = x27) %>%
    extract_emotion(emotion = "disgust", column_1 = x0, column_2 = x1, column_3 = x2, column_4 = x3,
                    column_5 = x4, column_6 = x5, column_7 = x6, column_8 = x7,
                    column_9 = x8, column_10 = x9, column_11 = x10, column_12 = x11,
                    column_13 = x12, column_14 = x13, column_15 = x14, column_16 = x15,
                    column_17 = x16, column_18 = x17, column_19 = x18, column_20 = x19,
                    column_21 = x20, column_22 = x21, column_23 = x22, column_24 = x23,
                    column_25 = x24, column_26 = x25, column_27 = x26, column_28 = x27) %>%
    extract_emotion(emotion = "embarrassment", column_1 = x0, column_2 = x1, column_3 = x2, column_4 = x3,
                    column_5 = x4, column_6 = x5, column_7 = x6, column_8 = x7,
                    column_9 = x8, column_10 = x9, column_11 = x10, column_12 = x11,
                    column_13 = x12, column_14 = x13, column_15 = x14, column_16 = x15,
                    column_17 = x16, column_18 = x17, column_19 = x18, column_20 = x19,
                    column_21 = x20, column_22 = x21, column_23 = x22, column_24 = x23,
                    column_25 = x24, column_26 = x25, column_27 = x26, column_28 = x27) %>%
    extract_emotion(emotion = "excitement", column_1 = x0, column_2 = x1, column_3 = x2, column_4 = x3,
                    column_5 = x4, column_6 = x5, column_7 = x6, column_8 = x7,
                    column_9 = x8, column_10 = x9, column_11 = x10, column_12 = x11,
                    column_13 = x12, column_14 = x13, column_15 = x14, column_16 = x15,
                    column_17 = x16, column_18 = x17, column_19 = x18, column_20 = x19,
                    column_21 = x20, column_22 = x21, column_23 = x22, column_24 = x23,
                    column_25 = x24, column_26 = x25, column_27 = x26, column_28 = x27) %>%
    extract_emotion(emotion = "fear", column_1 = x0, column_2 = x1, column_3 = x2, column_4 = x3,
                    column_5 = x4, column_6 = x5, column_7 = x6, column_8 = x7,
                    column_9 = x8, column_10 = x9, column_11 = x10, column_12 = x11,
                    column_13 = x12, column_14 = x13, column_15 = x14, column_16 = x15,
                    column_17 = x16, column_18 = x17, column_19 = x18, column_20 = x19,
                    column_21 = x20, column_22 = x21, column_23 = x22, column_24 = x23,
                    column_25 = x24, column_26 = x25, column_27 = x26, column_28 = x27) %>%
    extract_emotion(emotion = "gratitude", column_1 = x0, column_2 = x1, column_3 = x2, column_4 = x3,
                    column_5 = x4, column_6 = x5, column_7 = x6, column_8 = x7,
                    column_9 = x8, column_10 = x9, column_11 = x10, column_12 = x11,
                    column_13 = x12, column_14 = x13, column_15 = x14, column_16 = x15,
                    column_17 = x16, column_18 = x17, column_19 = x18, column_20 = x19,
                    column_21 = x20, column_22 = x21, column_23 = x22, column_24 = x23,
                    column_25 = x24, column_26 = x25, column_27 = x26, column_28 = x27) %>%
    extract_emotion(emotion = "grief", column_1 = x0, column_2 = x1, column_3 = x2, column_4 = x3,
                    column_5 = x4, column_6 = x5, column_7 = x6, column_8 = x7,
                    column_9 = x8, column_10 = x9, column_11 = x10, column_12 = x11,
                    column_13 = x12, column_14 = x13, column_15 = x14, column_16 = x15,
                    column_17 = x16, column_18 = x17, column_19 = x18, column_20 = x19,
                    column_21 = x20, column_22 = x21, column_23 = x22, column_24 = x23,
                    column_25 = x24, column_26 = x25, column_27 = x26, column_28 = x27) %>%
    extract_emotion(emotion = "joy", column_1 = x0, column_2 = x1, column_3 = x2, column_4 = x3,
                    column_5 = x4, column_6 = x5, column_7 = x6, column_8 = x7,
                    column_9 = x8, column_10 = x9, column_11 = x10, column_12 = x11,
                    column_13 = x12, column_14 = x13, column_15 = x14, column_16 = x15,
                    column_17 = x16, column_18 = x17, column_19 = x18, column_20 = x19,
                    column_21 = x20, column_22 = x21, column_23 = x22, column_24 = x23,
                    column_25 = x24, column_26 = x25, column_27 = x26, column_28 = x27) %>%
    extract_emotion(emotion = "love", column_1 = x0, column_2 = x1, column_3 = x2, column_4 = x3,
                    column_5 = x4, column_6 = x5, column_7 = x6, column_8 = x7,
                    column_9 = x8, column_10 = x9, column_11 = x10, column_12 = x11,
                    column_13 = x12, column_14 = x13, column_15 = x14, column_16 = x15,
                    column_17 = x16, column_18 = x17, column_19 = x18, column_20 = x19,
                    column_21 = x20, column_22 = x21, column_23 = x22, column_24 = x23,
                    column_25 = x24, column_26 = x25, column_27 = x26, column_28 = x27) %>%
    extract_emotion(emotion = "nervousness", column_1 = x0, column_2 = x1, column_3 = x2, column_4 = x3,
                    column_5 = x4, column_6 = x5, column_7 = x6, column_8 = x7,
                    column_9 = x8, column_10 = x9, column_11 = x10, column_12 = x11,
                    column_13 = x12, column_14 = x13, column_15 = x14, column_16 = x15,
                    column_17 = x16, column_18 = x17, column_19 = x18, column_20 = x19,
                    column_21 = x20, column_22 = x21, column_23 = x22, column_24 = x23,
                    column_25 = x24, column_26 = x25, column_27 = x26, column_28 = x27) %>%
    extract_emotion(emotion = "optimism", column_1 = x0, column_2 = x1, column_3 = x2, column_4 = x3,
                    column_5 = x4, column_6 = x5, column_7 = x6, column_8 = x7,
                    column_9 = x8, column_10 = x9, column_11 = x10, column_12 = x11,
                    column_13 = x12, column_14 = x13, column_15 = x14, column_16 = x15,
                    column_17 = x16, column_18 = x17, column_19 = x18, column_20 = x19,
                    column_21 = x20, column_22 = x21, column_23 = x22, column_24 = x23,
                    column_25 = x24, column_26 = x25, column_27 = x26, column_28 = x27) %>%
    extract_emotion(emotion = "pride", column_1 = x0, column_2 = x1, column_3 = x2, column_4 = x3,
                    column_5 = x4, column_6 = x5, column_7 = x6, column_8 = x7,
                    column_9 = x8, column_10 = x9, column_11 = x10, column_12 = x11,
                    column_13 = x12, column_14 = x13, column_15 = x14, column_16 = x15,
                    column_17 = x16, column_18 = x17, column_19 = x18, column_20 = x19,
                    column_21 = x20, column_22 = x21, column_23 = x22, column_24 = x23,
                    column_25 = x24, column_26 = x25, column_27 = x26, column_28 = x27) %>%
    extract_emotion(emotion = "realization", column_1 = x0, column_2 = x1, column_3 = x2, column_4 = x3,
                    column_5 = x4, column_6 = x5, column_7 = x6, column_8 = x7,
                    column_9 = x8, column_10 = x9, column_11 = x10, column_12 = x11,
                    column_13 = x12, column_14 = x13, column_15 = x14, column_16 = x15,
                    column_17 = x16, column_18 = x17, column_19 = x18, column_20 = x19,
                    column_21 = x20, column_22 = x21, column_23 = x22, column_24 = x23,
                    column_25 = x24, column_26 = x25, column_27 = x26, column_28 = x27) %>%
    extract_emotion(emotion = "relief", column_1 = x0, column_2 = x1, column_3 = x2, column_4 = x3,
                    column_5 = x4, column_6 = x5, column_7 = x6, column_8 = x7,
                    column_9 = x8, column_10 = x9, column_11 = x10, column_12 = x11,
                    column_13 = x12, column_14 = x13, column_15 = x14, column_16 = x15,
                    column_17 = x16, column_18 = x17, column_19 = x18, column_20 = x19,
                    column_21 = x20, column_22 = x21, column_23 = x22, column_24 = x23,
                    column_25 = x24, column_26 = x25, column_27 = x26, column_28 = x27) %>%
    extract_emotion(emotion = "remorse", column_1 = x0, column_2 = x1, column_3 = x2, column_4 = x3,
                    column_5 = x4, column_6 = x5, column_7 = x6, column_8 = x7,
                    column_9 = x8, column_10 = x9, column_11 = x10, column_12 = x11,
                    column_13 = x12, column_14 = x13, column_15 = x14, column_16 = x15,
                    column_17 = x16, column_18 = x17, column_19 = x18, column_20 = x19,
                    column_21 = x20, column_22 = x21, column_23 = x22, column_24 = x23,
                    column_25 = x24, column_26 = x25, column_27 = x26, column_28 = x27) %>%
    extract_emotion(emotion = "sadness", column_1 = x0, column_2 = x1, column_3 = x2, column_4 = x3,
                    column_5 = x4, column_6 = x5, column_7 = x6, column_8 = x7,
                    column_9 = x8, column_10 = x9, column_11 = x10, column_12 = x11,
                    column_13 = x12, column_14 = x13, column_15 = x14, column_16 = x15,
                    column_17 = x16, column_18 = x17, column_19 = x18, column_20 = x19,
                    column_21 = x20, column_22 = x21, column_23 = x22, column_24 = x23,
                    column_25 = x24, column_26 = x25, column_27 = x26, column_28 = x27) %>%
    extract_emotion(emotion = "surprise", column_1 = x0, column_2 = x1, column_3 = x2, column_4 = x3,
                    column_5 = x4, column_6 = x5, column_7 = x6, column_8 = x7,
                    column_9 = x8, column_10 = x9, column_11 = x10, column_12 = x11,
                    column_13 = x12, column_14 = x13, column_15 = x14, column_16 = x15,
                    column_17 = x16, column_18 = x17, column_19 = x18, column_20 = x19,
                    column_21 = x20, column_22 = x21, column_23 = x22, column_24 = x23,
                    column_25 = x24, column_26 = x25, column_27 = x26, column_28 = x27) %>%
    extract_emotion(emotion = "neutral", column_1 = x0, column_2 = x1, column_3 = x2, column_4 = x3,
                    column_5 = x4, column_6 = x5, column_7 = x6, column_8 = x7,
                    column_9 = x8, column_10 = x9, column_11 = x10, column_12 = x11,
                    column_13 = x12, column_14 = x13, column_15 = x14, column_16 = x15,
                    column_17 = x16, column_18 = x17, column_19 = x18, column_20 = x19,
                    column_21 = x20, column_22 = x21, column_23 = x22, column_24 = x23,
                    column_25 = x24, column_26 = x25, column_27 = x26, column_28 = x27) %>%
    dplyr::select(admiration, amusement, anger, annoyance, approval, caring, confusion, curiosity, desire, disappointment, disapproval, disgust, embarrassment, excitement, fear, gratitude, grief, joy, love, nervousness, optimism, pride, realization, relief, remorse, sadness, surprise, neutral)

}
